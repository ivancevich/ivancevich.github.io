<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Ignoring invalid SSL certificates on Cordova for Android and iOS - Futuristic Web and Mobile Development Blog - JC Ivancevich
    </title>
    <link rel="alternate" href="http://ivancevich.me/feed.xml" type="application/rss+xml" title="Futuristic Web and Mobile Development Blog">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic|Anonymous+Pro:400,700,400italic,700italic|Merriweather:400,700,300">
    <link rel="stylesheet" href="/css/main.css">
  </head>
  <body class="article-detail">
    <header class="header">
      <div class="content-wrap">
        <h1>Ignoring invalid SSL certificates on Cordova for Android and iOS</h1>
        <p class="author">Written by <span class="author"><a href="/">JC Ivancevich</a></span>
        </p>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article">
          <section class="content"><p>When developing <strong>mobile apps</strong>, it’s very common that we have to connect to web services or APIs which may be secure (https) but are still under development, so its <strong><span class="caps">SSL</span> certificate is not valid</strong> or&nbsp;self-signed.</p>
<blockquote>
<p>This would happen unless you want to spend a hundred bucks on a wildcard certificate for development&nbsp;environments.</p>
</blockquote>
<p>For cases like the mentioned above it’s useful to be able to <strong>ignore errors</strong> generated by invalid certificates, <strong>so we can test the app, install it on any device</strong>, etc.</p>
<p>In order to get rid of this problem, the process changes depending on the platform we’re&nbsp;targeting.</p>
<h2 id="ios-objective-c-swift-cordova-">iOS (Objective-C / Swift /&nbsp;Cordova)</h2>
<p>iOS will <strong>always complain</strong> about invalid certificates, either in debug or release mode. To avoid this you should place the following code at the end of the <code>AppDelegate.m</code> file.</p>
<pre><code class="lang-objective-c">@implementation NSURLRequest(DataController)
+ (BOOL)allowsAnyHTTPSCertificateForHost:(NSString *)host
{
    return YES;
}
@end
</code></pre>
<blockquote>
<p>For Cordova users this file is placed&nbsp;in</p>
<pre><code>project/platforms/ios/Project/Classes/AppDelegate.m
</code></pre><p>Thanks to <a href="http://machadogj.com">@machadogj</a> for this&nbsp;one!</p>
</blockquote>
<hr>
<h2 id="android-cordova-specific-">Android (Cordova specific)</h2>
<p>In Android the history is different.
It will <strong>allow</strong> you to make requests to services with invalid certificates, but only if the app is <strong>compiled in build mode</strong>.
On the other hand, when you would build the app in <strong>release mode</strong> <em>(ie: to send the <span class="caps">APK</span> to a co-worker or stuff like that)</em>, the Cordova Web View, which is where the <span class="caps">HTML</span> + <span class="caps">CSS</span> + <span class="caps">JS</span> you wrote runs, <strong>will not allow</strong> you to make “insecure” requests.
Once again, to avoid this you should modify a platform file. In this case the file will be <code>CordovaWebViewClient.java</code></p>
<p>You would need to modify a method in the mentioned filed, like&nbsp;this:</p>
<pre><code class="lang-java"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedSslError</span><span class="params">(WebView view, SslErrorHandler handler, SslError error)</span> </span>{
  <span class="keyword">final</span> String packageName = <span class="keyword">this</span>.cordova.getActivity().getPackageName();
  <span class="keyword">final</span> PackageManager pm = <span class="keyword">this</span>.cordova.getActivity().getPackageManager();

  ApplicationInfo appInfo;
  <span class="keyword">try</span> {
    appInfo = pm.getApplicationInfo(packageName, PackageManager.GET_META_DATA);
    <span class="keyword">if</span> ((appInfo.flags <span class="amp">&amp;</span> ApplicationInfo.FLAG_DEBUGGABLE) != <span class="number">0</span>) {
      <span class="comment">// debug = true</span>
      handler.proceed();
      <span class="keyword">return</span>;
    } <span class="keyword">else</span> {
      <span class="comment">// debug = false</span>
      <span class="comment">// <span class="caps">THIS</span> <span class="caps">IS</span> <span class="caps">WHAT</span> <span class="caps">YOU</span> <span class="caps">NEED</span> <span class="caps">TO</span> <span class="caps">CHANGE</span>:</span>
      <span class="comment">// 1. <span class="caps">COMMENT</span> <span class="caps">THIS</span> <span class="caps">LINE</span></span>
      <span class="comment">// super.onReceivedSslError(view, handler, error);</span>
      <span class="comment">// 2. <span class="caps">ADD</span> <span class="caps">THESE</span> <span class="caps">TWO</span> <span class="caps">LINES</span></span>
      <span class="comment">// ----&gt;</span>
      handler.proceed();
      <span class="keyword">return</span>;
      <span class="comment">// &lt;----</span>
    }
  } <span class="keyword">catch</span> (NameNotFoundException e) {
    <span class="comment">// When it doubt, lock it out!</span>
    <span class="keyword">super</span>.onReceivedSslError(view, handler, error);
  }
}
</code></pre>
<blockquote>
<p>This file is placed&nbsp;in </p>
<pre><code>project/platforms/android/CordovaLib/src/org/apache/cordova/CordovaWebViewClient.java
</code></pre></blockquote>
<hr>
<p>That’s all.</p>
<blockquote>
<p>One thing I’d like to point at is that <strong>you should not use these solutions for production apps</strong>. This is just to test them or share them with&nbsp;co-workers.</p>
</blockquote>
<p>If you have any comment <strong>feel free to drop me a line</strong> through the comments&nbsp;below.</p>
<p>Thanks for reading!</p>
</section>
        </article>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_shortname = 'ivancevich';
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/">« Full blog</a></div>
        <section class="about">
        </section>
        <section class="copy">
          <p>&copy; 2015 JC Ivancevich</p>
        </section>
      </div>
    </footer>
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-52650401-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>